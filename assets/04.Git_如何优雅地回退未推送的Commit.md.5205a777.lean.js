import{_ as a,o as l,c as e,a as n}from"./app.7c6fd316.js";const u=JSON.parse('{"title":"如何优雅地回退未推送的 Commit","description":"","frontmatter":{},"headers":[{"level":2,"title":"一、核心解决方案：git reset 三剑客","slug":"一、核心解决方案-git-reset-三剑客","link":"#一、核心解决方案-git-reset-三剑客","children":[{"level":3,"title":"1. 后悔药模式：保留所有修改（--soft）","slug":"_1-后悔药模式-保留所有修改-soft","link":"#_1-后悔药模式-保留所有修改-soft","children":[]},{"level":3,"title":"2. 半保留模式：取消暂存（--mixed，默认选项）","slug":"_2-半保留模式-取消暂存-mixed-默认选项","link":"#_2-半保留模式-取消暂存-mixed-默认选项","children":[]},{"level":3,"title":"3. 毁灭模式：彻底删除修改（--hard，慎用！）","slug":"_3-毁灭模式-彻底删除修改-hard-慎用","link":"#_3-毁灭模式-彻底删除修改-hard-慎用","children":[]}]},{"level":2,"title":"二、操作后验证技巧","slug":"二、操作后验证技巧","link":"#二、操作后验证技巧","children":[]},{"level":2,"title":"三、实战案例演示","slug":"三、实战案例演示","link":"#三、实战案例演示","children":[{"level":3,"title":"场景还原","slug":"场景还原","link":"#场景还原","children":[]},{"level":3,"title":"修复流程","slug":"修复流程","link":"#修复流程","children":[]}]},{"level":2,"title":"四、避坑指南 ⚠️","slug":"四、避坑指南-⚠️","link":"#四、避坑指南-⚠️","children":[]},{"level":2,"title":"五、知识扩展 🔍","slug":"五、知识扩展-🔍","link":"#五、知识扩展-🔍","children":[]},{"level":2,"title":"六、总结","slug":"六、总结","link":"#六、总结","children":[]}],"relativePath":"04.Git/如何优雅地回退未推送的Commit.md","lastUpdated":1763393448000}'),i={name:"04.Git/如何优雅地回退未推送的Commit.md"};function t(o,s,r,p,c,d){return l(),e("div",{"data-pagefind-body":!0},[...s[0]||(s[0]=[n(`<h1 id="如何优雅地回退未推送的-commit" tabindex="-1">如何优雅地回退未推送的 Commit <a class="header-anchor" href="#如何优雅地回退未推送的-commit" aria-hidden="true">#</a></h1><hr><h1 id="git-本地提交撤销指南-如何优雅地回退未推送的-commit" tabindex="-1">Git 本地提交撤销指南：如何优雅地回退未推送的 Commit <a class="header-anchor" href="#git-本地提交撤销指南-如何优雅地回退未推送的-commit" aria-hidden="true">#</a></h1><blockquote><p><strong>📝 前言</strong><br> 在 Git 版本控制中，我们经常会遇到需要撤销本地提交的情况。例如：</p><ul><li>提交了错误的代码</li><li>漏掉了某些文件</li><li>提交信息（Commit Message）写错了</li></ul><p><strong>如果你还没有将提交推送（<code>push</code>）到远程仓库</strong>，这篇文章将为你提供三种安全高效的撤销方案。即使你不小心手滑了，也能轻松挽回！</p></blockquote><hr><h2 id="一、核心解决方案-git-reset-三剑客" tabindex="-1">一、核心解决方案：<code>git reset</code> 三剑客 <a class="header-anchor" href="#一、核心解决方案-git-reset-三剑客" aria-hidden="true">#</a></h2><h3 id="_1-后悔药模式-保留所有修改-soft" tabindex="-1">1. 后悔药模式：保留所有修改（<code>--soft</code>） <a class="header-anchor" href="#_1-后悔药模式-保留所有修改-soft" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--soft</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">HEAD~1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><strong>适用场景</strong><ul><li>需要修改提交信息</li><li>想重新组织代码变更（例如拆分/合并提交）</li></ul></li><li><strong>效果</strong><ul><li>撤销提交，但保留工作目录和暂存区的修改</li><li>相当于按下了&quot;撤回提交但保留代码&quot;的后悔键</li></ul></li></ul><hr><h3 id="_2-半保留模式-取消暂存-mixed-默认选项" tabindex="-1">2. 半保留模式：取消暂存（<code>--mixed</code>，默认选项） <a class="header-anchor" href="#_2-半保留模式-取消暂存-mixed-默认选项" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">HEAD~1</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;"># 等价于 git reset --mixed HEAD~1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><strong>适用场景</strong><ul><li>需要重新选择要提交的文件（例如漏了某个文件）</li><li>想检查代码后再提交</li></ul></li><li><strong>效果</strong><ul><li>撤销提交，保留工作目录修改</li><li>但取消所有文件的暂存状态（<code>git add</code> 操作会被清除）</li></ul></li></ul><hr><h3 id="_3-毁灭模式-彻底删除修改-hard-慎用" tabindex="-1">3. 毁灭模式：彻底删除修改（<code>--hard</code>，慎用！） <a class="header-anchor" href="#_3-毁灭模式-彻底删除修改-hard-慎用" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--hard</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">HEAD~1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><strong>适用场景</strong><ul><li>确定本次提交的代码完全无用</li><li>需要快速回滚到干净状态</li></ul></li><li><strong>效果</strong><ul><li>撤销提交并<strong>永久删除所有修改</strong></li><li>工作目录和暂存区会完全回退到上一次提交的状态</li></ul></li></ul><hr><h2 id="二、操作后验证技巧" tabindex="-1">二、操作后验证技巧 <a class="header-anchor" href="#二、操作后验证技巧" aria-hidden="true">#</a></h2><p>执行完 <code>git reset</code> 后，建议通过以下命令确认状态：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">log</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--oneline</span><span style="color:#BABED8;">   </span><span style="color:#676E95;font-style:italic;"># 查看提交历史是否缩短</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">status</span><span style="color:#BABED8;">          </span><span style="color:#676E95;font-style:italic;"># 检查文件状态是否符合预期</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><hr><h2 id="三、实战案例演示" tabindex="-1">三、实战案例演示 <a class="header-anchor" href="#三、实战案例演示" aria-hidden="true">#</a></h2><h3 id="场景还原" tabindex="-1">场景还原 <a class="header-anchor" href="#场景还原" aria-hidden="true">#</a></h3><ol><li>你修改了 <code>index.html</code> 和 <code>style.css</code></li><li>执行了 <code>git add .</code> 和 <code>git commit -m &quot;Update styles&quot;</code></li><li>突然发现漏了 <code>script.js</code> 文件</li></ol><h3 id="修复流程" tabindex="-1">修复流程 <a class="header-anchor" href="#修复流程" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 1. 撤销最近提交（保留修改）</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">reset</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--soft</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">HEAD~1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 2. 添加漏掉的文件</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">add</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">script.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 3. 重新提交</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">commit</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">更新样式和脚本文件</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><hr><h2 id="四、避坑指南-⚠️" tabindex="-1">四、避坑指南 ⚠️ <a class="header-anchor" href="#四、避坑指南-⚠️" aria-hidden="true">#</a></h2><ol><li><p><strong>确认未推送</strong><br> 执行操作前务必用 <code>git log</code> 对比本地与远程仓库的提交记录，确保未推送（可通过 <code>git log origin/main..HEAD</code> 查看差异）</p></li><li><p><strong>备份大法好</strong><br> 如果不确定操作后果，建议：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">stash</span><span style="color:#BABED8;">        </span><span style="color:#676E95;font-style:italic;"># 暂存当前修改</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">stash</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">apply</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;"># 需要时恢复修改</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p><strong>HEAD~N 的含义</strong></p><ul><li><code>HEAD~1</code>：回退 1 个提交</li><li><code>HEAD~3</code>：回退 3 个提交</li><li>可通过 <code>git reflog</code> 查看所有操作记录</li></ul></li><li><p><strong>远程仓库已推送怎么办？</strong><br> 如果误操作已经推送，只能通过强制推送覆盖：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">push</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-f</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>但会改写历史记录，可能导致协作冲突，需谨慎使用！</p></li></ol><hr><h2 id="五、知识扩展-🔍" tabindex="-1">五、知识扩展 🔍 <a class="header-anchor" href="#五、知识扩展-🔍" aria-hidden="true">#</a></h2><ul><li><p><strong>撤销的替代方案</strong><br> 使用 <code>git commit --amend</code> 可以修改最近一次提交（合并修改到上一次提交）</p></li><li><p><strong>可视化工具推荐</strong><br> 使用 <code>gitk</code> 或 VS Code 的 GitLens 插件，可以更直观地查看提交树</p></li></ul><hr><h2 id="六、总结" tabindex="-1">六、总结 <a class="header-anchor" href="#六、总结" aria-hidden="true">#</a></h2><p>通过合理使用 <code>git reset</code>，我们可以轻松应对本地提交的各种翻车场景。记住这三个黄金口诀：</p><blockquote><ul><li>想改提交信息 → <code>--soft</code></li><li>想重选提交文件 → <code>--mixed</code></li><li>想彻底删除提交 → <code>--hard</code></li></ul></blockquote><p><strong>最后提醒</strong>：对已推送的提交进行操作时，请务必与团队沟通，避免引发协作灾难！</p>`,38)])])}const g=a(i,[["render",t]]);export{u as __pageData,g as default};
